<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–í—Ö—ñ–¥ ‚Äì FoodMatch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        /* --- –°–¢–ò–õ–Ü --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body { 
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; 
            background: #f5f5f7; 
            color: #111827; 
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .logo-container { margin-bottom: 24px; text-align: center; }
        
        .logo {
            display: inline-flex; align-items: center; gap: 10px;
            font-weight: 700; font-size: 1.5rem; text-decoration: none; color: #111827;
        }

        .logo-badge {
            width: 40px; height: 40px; border-radius: 999px;
            background: radial-gradient(circle at 30% 30%, #fee2e2, #f97316);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.18);
        }

        .auth-card {
            background: #ffffff; border-radius: 24px; padding: 40px;
            width: 100%; max-width: 400px; box-shadow: 0 18px 40px rgba(15, 23, 42, 0.08);
        }

        .auth-header { margin-bottom: 24px; text-align: center; }
        .auth-header h1 { font-size: 1.5rem; margin-bottom: 8px; }
        .auth-header p { color: #6b7280; font-size: 0.9rem; }

        .form-group { margin-bottom: 16px; }
        
        label { display: block; font-size: 0.85rem; font-weight: 600; color: #374151; margin-bottom: 6px; }

        input {
            width: 100%; padding: 10px 14px; border: 1px solid #e5e7eb; border-radius: 12px;
            font-size: 0.95rem; outline: none; transition: border-color 0.15s;
        }
        input:focus { border-color: #111827; box-shadow: 0 0 0 3px rgba(17, 24, 39, 0.05); }

        .btn-primary {
            width: 100%; background: #111827; color: #fefce8; padding: 12px;
            border-radius: 999px; font-weight: 600; font-size: 1rem; border: none;
            cursor: pointer; transition: transform 0.1s; margin-top: 10px;
        }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 14px rgba(15, 23, 42, 0.2); }

        .auth-footer {
            margin-top: 24px; text-align: center; font-size: 0.9rem; color: #6b7280;
            border-top: 1px solid #f3f4f6; padding-top: 20px;
        }

        .link { color: #f97316; text-decoration: none; font-weight: 600; cursor: pointer; }
        .link:hover { text-decoration: underline; }

        .back-link {
            display: inline-block; margin-top: 20px; color: #9ca3af; font-size: 0.85rem; text-decoration: none;
        }
        .back-link:hover { color: #4b5563; }

        @media (max-width: 480px) { .auth-card { padding: 24px; } }
    </style>
</head>
<body>

    <div class="logo-container">
        <a href="index.html" class="logo">
            <div class="logo-badge">üçΩ</div>
            FoodMatch
        </a>
    </div>

    <div class="auth-card">
        <div id="loginForm">
            <div class="auth-header">
                <h1>–ó –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º!</h1>
                <p>–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—ó –¥–∞–Ω—ñ, —â–æ–± —É–≤—ñ–π—Ç–∏</p>
            </div>
            <form>
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="name@email.com" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button type="button" id="btnLogin" class="btn-primary">–£–≤—ñ–π—Ç–∏</button>
            </form>
            <div class="auth-footer">
                –ù–µ–º–∞—î –∞–∫–∞—É–Ω—Ç—É? <span class="link" onclick="toggleAuth()">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</span>
            </div>
        </div>

        <div id="registerForm" style="display: none;">
            <div class="auth-header">
                <h1>–°—Ç–≤–æ—Ä–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç</h1>
                <p>–ó–±–µ—Ä–µ–∂—ñ—Ç—å —Å–≤–æ—ó –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–µ—Ü–µ–ø—Ç–∏</p>
            </div>
            <form>
                <div class="form-group">
                    <label for="regName">–Ü–º º—è</label>
                    <input type="text" id="regName" placeholder="–Ø–∫ –¥–æ –≤–∞—Å –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è?">
                </div>
                <div class="form-group">
                    <label for="regEmail">Email</label>
                    <input type="email" id="regEmail" placeholder="name@email.com">
                </div>
                <div class="form-group">
                    <label for="regPassword">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="regPassword" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <button type="button" id="btnRegister" class="btn-primary">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
            </form>
            <div class="auth-footer">
                –í–∂–µ —î –∞–∫–∞—É–Ω—Ç? <span class="link" onclick="toggleAuth()">–£–≤—ñ–π—Ç–∏</span>
            </div>
        </div>
    </div>

    <a href="index.html" class="back-link">‚Üê –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É</a>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script src="js/db.js"></script>

    <script>
        // --- –ü–ï–†–ï–í–Ü–†–ö–ê: –ß–ò –ú–ò –í–ñ–ï –í –°–ò–°–¢–ï–ú–Ü? ---
async function checkSession() {
    const { data } = await supabase.auth.getSession();
    if (data.session) {
        // –Ø–∫—â–æ —Å–µ—Å—ñ—è —î ‚Äî –æ–¥—Ä–∞–∑—É –∫–∏–¥–∞—î–º–æ –≤ –ø—Ä–æ—Ñ—ñ–ª—å
        window.location.href = "profile.html";
    }
}
checkSession();
        // –ü–µ—Ä–µ–º–∏–∫–∞—á –í—Ö—ñ–¥/–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
        function toggleAuth() {
            const loginBlock = document.getElementById('loginForm');
            const registerBlock = document.getElementById('registerForm');

            if (loginBlock.style.display === 'none') {
                loginBlock.style.display = 'block';
                registerBlock.style.display = 'none';
                document.title = "–í—Ö—ñ–¥ ‚Äì FoodMatch";
            } else {
                loginBlock.style.display = 'none';
                registerBlock.style.display = 'block';
                document.title = "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è ‚Äì FoodMatch";
            }
        }

        // --- –õ–û–ì–Ü–ö–ê –†–ï–Ñ–°–¢–†–ê–¶–Ü–á ---
        async function handleRegister() {
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;

            if(!email || !password) {
                alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å email —Ç–∞ –ø–∞—Ä–æ–ª—å");
                return;
            }

            // –§—É–Ω–∫—Ü—ñ—è supabase –±–µ—Ä–µ—Ç—å—Å—è –∑ —Ñ–∞–π–ª—É js/db.js
            const { data, error } = await supabase.auth.signUp({
                email: email,
                password: password,
                options: {
                    data: { full_name: name }
                }
            });

            if (error) {
                alert("–ü–æ–º–∏–ª–∫–∞: " + error.message);
            } else {
                alert("–£—Å–ø—ñ—Ö! –ê–∫–∞—É–Ω—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ. –¢–µ–ø–µ—Ä —Å–ø—Ä–æ–±—É–π—Ç–µ —É–≤—ñ–π—Ç–∏.");
                toggleAuth(); 
            }
        }

        // --- –õ–û–ì–Ü–ö–ê –í–•–û–î–£ ---
        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            const { data, error } = await supabase.auth.signInWithPassword({
                email: email,
                password: password,
            });

            if (error) {
                alert("–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É: " + error.message);
            } else {
                // –£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥ -> –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –Ω–∞ –ø—Ä–æ—Ñ—ñ–ª—å
                console.log("–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥:", data);
                window.location.href = "profile.html";
            }
        }

        // –ü—Ä–∏–≤'—è–∑—É—î–º–æ –∫–Ω–æ–ø–∫–∏
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById('btnRegister').onclick = handleRegister;
            document.getElementById('btnLogin').onclick = handleLogin;
        });
    </script>

</body>
</html>